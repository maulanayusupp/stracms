it should be easy to optimize the code and remove unused code.
